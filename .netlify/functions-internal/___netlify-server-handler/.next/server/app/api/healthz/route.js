(()=>{var e={};e.id=7579,e.ids=[7579],e.modules={4665:e=>{function t(e){return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=4665,e.exports=t},53524:e=>{"use strict";e.exports=require("@prisma/client")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},85807:e=>{"use strict";e.exports=require("module")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},23425:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>R,patchFetch:()=>S,requestAsyncStorage:()=>E,routeModule:()=>_,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>d,dynamic:()=>p});var o=r(49303),a=r(88716),n=r(60670),i=r(87070),l=r(9487),u=r(1964),c=r(29837);let p="force-dynamic";async function d(e){let t=Date.now();try{let e="healthy",r=0;try{let e=Date.now();await l.db.$queryRaw`SELECT 1`,r=Date.now()-e}catch(t){e="unhealthy"}let s="not_configured";if(u.OB.REDIS_URL)try{s="healthy"}catch(e){s="unhealthy"}let o="healthy",a=null;try{u.OB.REDIS_URL?a=await (0,c.FH)():(o="not_configured",a={message:"Redis not configured"})}catch(e){o="unhealthy",a={error:e.message}}let n={stripe:u.OB.STRIPE_SECRET_KEY?"configured":"not_configured",razorpay:u.OB.RAZORPAY_KEY_ID?"configured":"not_configured",email:u.OB.SMTP_HOST?"configured":"not_configured",sms:u.OB.TWILIO_ACCOUNT_SID?"configured":"not_configured"},p="healthy"===e?"healthy":"unhealthy",d=Date.now()-t,_={status:p,timestamp:new Date().toISOString(),responseTime:`${d}ms`,version:process.env.npm_package_version||"1.0.0",environment:u.OB.NODE_ENV,services:{database:{status:e,latency:`${r}ms`},redis:{status:s,latency:void 0},queues:{status:o,stats:a},external:n}};return i.NextResponse.json(_,{status:"healthy"===p?200:503,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}})}catch(r){let e=Date.now()-t;return i.NextResponse.json({status:"unhealthy",timestamp:new Date().toISOString(),responseTime:`${e}ms`,error:r.message},{status:503,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}})}}let _=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/healthz/route",pathname:"/api/healthz",filename:"route",bundlePath:"app/api/healthz/route"},resolvedPagePath:"/Users/kumar/Business admin/tripfluence-admin/app/api/healthz/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:E,staticGenerationAsyncStorage:m,serverHooks:h}=_,R="/api/healthz/route";function S(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},29837:(e,t,r)=>{"use strict";r.d(t,{BN:()=>_,DJ:()=>E,FH:()=>O,Y$:()=>y,aL:()=>m});var s=r(26608),o=r(1964),a=r(57435);let n=o.OB.REDIS_URL?{host:new URL(o.OB.REDIS_URL).hostname,port:parseInt(new URL(o.OB.REDIS_URL).port),password:new URL(o.OB.REDIS_URL).password}:null,i=n?new s.ci("social",{connection:n}):null,l=n?new s.ci("event-sync",{connection:n}):null,u=n?new s.ci("webhook",{connection:n}):null,c=n?new s.ci("email",{connection:n}):null,p=n?new s.ci("sms",{connection:n}):null,d=n?new s.ci("space",{connection:n}):null,_=async(e,t)=>i?i.add("publish",e,{delay:e.scheduledAt?new Date(e.scheduledAt).getTime()-Date.now():0,attempts:3,backoff:{type:"exponential",delay:2e3},...t}):(a.k.warn("Redis not configured, skipping social publish job"),null),E=async(e,t)=>l?l.add("sync",e,{attempts:3,backoff:{type:"exponential",delay:5e3},...t}):(a.k.warn("Redis not configured, skipping event sync job"),null),m=async(e,t)=>u?u.add("dispatch",e,{attempts:5,backoff:{type:"exponential",delay:1e3},...t}):(a.k.warn("Redis not configured, skipping webhook job"),null),h=async(e,t)=>c?c.add("send",e,{attempts:3,backoff:{type:"exponential",delay:2e3},...t}):(a.k.warn("Redis not configured, skipping email job"),null),R=async(e,t)=>p?p.add("send",e,{attempts:3,backoff:{type:"exponential",delay:2e3},...t}):(a.k.warn("Redis not configured, skipping SMS job"),null),S=async(e,t)=>d?d.add("hold-expire",e,{attempts:1,...t}):(a.k.warn("Redis not configured, skipping space hold expire job"),null),y=async(e,t,r)=>{switch(e){case"socialPublish":return _(t,r);case"eventSync":return E(t,r);case"webhook":return m(t,r);case"email":return h(t,r);case"sms":return R(t,r);case"spaceHoldExpire":return S(t,r);default:throw Error(`Unknown queue: ${e}`)}},O=async()=>{if(!o.OB.REDIS_URL)return{social:{waiting:0,active:0,completed:0,failed:0,delayed:0},eventSync:{waiting:0,active:0,completed:0,failed:0,delayed:0},webhook:{waiting:0,active:0,completed:0,failed:0,delayed:0},email:{waiting:0,active:0,completed:0,failed:0,delayed:0},sms:{waiting:0,active:0,completed:0,failed:0,delayed:0},space:{waiting:0,active:0,completed:0,failed:0,delayed:0}};let[e,t,r,s,a,n]=await Promise.all([i.getJobCounts(),l.getJobCounts(),u.getJobCounts(),c.getJobCounts(),p.getJobCounts(),d.getJobCounts()]);return{social:e,eventSync:t,webhook:r,email:s,sms:a,space:n}}},9487:(e,t,r)=>{"use strict";r.d(t,{db:()=>i});var s=r(53524),o=r(1964);let a=globalThis,n=()=>({$queryRaw:()=>Promise.resolve([]),$executeRaw:()=>Promise.resolve(0),$transaction:e=>e({}),user:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},business:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},space:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},socialAccount:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},webhookDelivery:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},auditLog:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},spaceAvailability:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},spaceRequest:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)}}),i=(()=>{process.env.SKIP_ENV_VALIDATION;try{return a.prisma??new s.PrismaClient({log:"development"===o.OB.NODE_ENV?["query","error","warn"]:["error"],datasources:{db:{url:o.OB.DATABASE_URL}}})}catch(e){return console.warn("Database connection failed during build, using mock database:",e),n()}return a.prisma??new s.PrismaClient({log:"development"===o.OB.NODE_ENV?["query","error","warn"]:["error"],datasources:{db:{url:o.OB.DATABASE_URL}}})})();"production"!==o.OB.NODE_ENV&&(a.prisma=i)},1964:(e,t,r)=>{"use strict";r.d(t,{OB:()=>a});var s=r(88879);let o=s.Ryn({DATABASE_URL:s.Z_8().url("Invalid database URL"),REDIS_URL:s.Z_8().url("Invalid Redis URL").optional(),JWT_SECRET:s.Z_8().min(32,"JWT secret must be at least 32 characters"),NEXTAUTH_SECRET:s.Z_8().min(32,"NextAuth secret must be at least 32 characters").optional(),NEXTAUTH_URL:s.Z_8().url("Invalid NextAuth URL").optional(),STRIPE_SECRET_KEY:s.Z_8().startsWith("sk_","Invalid Stripe secret key").optional(),STRIPE_PUBLISHABLE_KEY:s.Z_8().startsWith("pk_","Invalid Stripe publishable key").optional(),STRIPE_WEBHOOK_SECRET:s.Z_8().optional(),RAZORPAY_KEY_ID:s.Z_8().optional(),RAZORPAY_KEY_SECRET:s.Z_8().optional(),RAZORPAY_WEBHOOK_SECRET:s.Z_8().optional(),WEBHOOK_SECRET:s.Z_8().min(32,"Webhook secret must be at least 32 characters"),FACEBOOK_APP_ID:s.Z_8().optional(),FACEBOOK_APP_SECRET:s.Z_8().optional(),FACEBOOK_PAGE_CONFIG_ID:s.Z_8().optional(),INSTAGRAM_CONFIG_ID:s.Z_8().optional(),GOOGLE_CLIENT_ID:s.Z_8().optional(),GOOGLE_CLIENT_SECRET:s.Z_8().optional(),EVENTBRITE_CLIENT_ID:s.Z_8().optional(),EVENTBRITE_CLIENT_SECRET:s.Z_8().optional(),MEETUP_CLIENT_ID:s.Z_8().optional(),MEETUP_CLIENT_SECRET:s.Z_8().optional(),OAUTH_REDIRECT_BASE:s.Z_8().url("Invalid OAuth redirect base URL").optional(),GRAPH_API_BASE:s.Z_8().url("Invalid Graph API base URL").default("https://graph.facebook.com"),GOOGLE_BUSINESS_API_BASE:s.Z_8().url("Invalid Google Business Profile API base URL").default("https://mybusiness.googleapis.com"),ENCRYPTION_KEY:s.Z_8().length(64,"Encryption key must be 64 hex characters (32 bytes)").optional(),FEATURE_REAL_PROVIDERS:s.Z_8().transform(e=>"true"===e).default("false"),SMTP_HOST:s.Z_8().optional(),SMTP_PORT:s.Z_8().transform(Number).optional(),SMTP_USER:s.Z_8().optional(),SMTP_PASSWORD:s.Z_8().optional(),SMTP_FROM:s.Z_8().email("Invalid SMTP from email").optional(),TWILIO_ACCOUNT_SID:s.Z_8().optional(),TWILIO_AUTH_TOKEN:s.Z_8().optional(),TWILIO_PHONE_NUMBER:s.Z_8().optional(),AWS_ACCESS_KEY_ID:s.Z_8().optional(),AWS_SECRET_ACCESS_KEY:s.Z_8().optional(),AWS_REGION:s.Z_8().optional(),AWS_S3_BUCKET:s.Z_8().optional(),SENTRY_DSN:s.Z_8().url("Invalid Sentry DSN").optional(),NODE_ENV:s.KmV(["development","production","test"]).default("development"),PORT:s.Z_8().transform(Number).default("3000")}),a=(()=>{if("true"===process.env.SKIP_ENV_VALIDATION)return{DATABASE_URL:process.env.DATABASE_URL||"postgresql://dummy:dummy@localhost:5432/dummy",JWT_SECRET:process.env.JWT_SECRET||"dummy-jwt-secret-key-minimum-32-characters-long",WEBHOOK_SECRET:process.env.WEBHOOK_SECRET||"dummy-webhook-secret-key-minimum-32-characters-long",NODE_ENV:"production",PORT:process.env.PORT||"3000",FEATURE_REAL_PROVIDERS:!1,GRAPH_API_BASE:"https://graph.facebook.com",GOOGLE_BUSINESS_API_BASE:"https://mybusiness.googleapis.com"};try{return o.parse(process.env)}catch(e){if(e instanceof s.jmq&&e.errors){let t=e.errors.filter(e=>"invalid_type"===e.code&&"undefined"===e.received).map(e=>e.path.join(".")),r=e.errors.filter(e=>"invalid_type"!==e.code).map(e=>`${e.path.join(".")}: ${e.message}`),s="Environment validation failed:\n";throw t.length>0&&(s+=`
Missing required variables:
${t.map(e=>`  - ${e}`).join("\n")}`),r.length>0&&(s+=`
Invalid variables:
${r.map(e=>`  - ${e}`).join("\n")}`),Error(s)}throw e}})();a.NODE_ENV,a.NODE_ENV,a.NODE_ENV},57435:(e,t,r)=>{"use strict";r.d(t,{k:()=>s});let s={info:(e,...t)=>{console.log(`[INFO] ${e}`,...t)},warn:(e,...t)=>{console.warn(`[WARN] ${e}`,...t)},error:(e,...t)=>{console.error(`[ERROR] ${e}`,...t)},debug:(e,...t)=>{}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,147,5972,6608],()=>r(23425));module.exports=s})();