"use strict";(()=>{var e={};e.id=6089,e.ids=[6089],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48826:(e,i,r)=>{r.r(i),r.d(i,{originalPathname:()=>P,patchFetch:()=>R,requestAsyncStorage:()=>E,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c});var n={};r.r(n),r.d(n,{GET:()=>_,dynamic:()=>d});var t=r(49303),o=r(88716),a=r(60670),s=r(87070),l=r(9487),u=r(67829);let d="force-dynamic";async function _(e,{params:i}){try{let{id:e}=await i,r=await l.db.space.findFirst({where:{id:e,status:"PUBLISHED"},include:{amenities:!0,rules:!0,pricingRules:!0,business:{select:{id:!0,name:!0,slug:!0,domain:!0}},_count:{select:{requests:{where:{status:"CONFIRMED"}}}}}});if(!r)return s.NextResponse.json({error:"Space not found"},{status:404});let n=(0,u.h0)(r.pricingRules);return s.NextResponse.json({...r,minHourlyRate:n})}catch(e){return console.error("Error fetching public space:",e),s.NextResponse.json({error:"Failed to fetch space"},{status:500})}}let p=new t.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/public/space/[id]/route",pathname:"/api/public/space/[id]",filename:"route",bundlePath:"app/api/public/space/[id]/route"},resolvedPagePath:"/Users/kumar/Business admin/tripfluence-admin/app/api/public/space/[id]/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:E,staticGenerationAsyncStorage:c,serverHooks:m}=p,P="/api/public/space/[id]/route";function R(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},9487:(e,i,r)=>{r.d(i,{db:()=>s});var n=r(53524),t=r(1964);let o=globalThis,a=()=>({$queryRaw:()=>Promise.resolve([]),$executeRaw:()=>Promise.resolve(0),$transaction:e=>e({}),user:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},business:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},space:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},socialAccount:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},webhookDelivery:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},auditLog:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},spaceAvailability:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},spaceRequest:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)}}),s=(()=>{process.env.SKIP_ENV_VALIDATION;try{return o.prisma??new n.PrismaClient({log:"development"===t.OB.NODE_ENV?["query","error","warn"]:["error"],datasources:{db:{url:t.OB.DATABASE_URL}}})}catch(e){return console.warn("Database connection failed during build, using mock database:",e),a()}return o.prisma??new n.PrismaClient({log:"development"===t.OB.NODE_ENV?["query","error","warn"]:["error"],datasources:{db:{url:t.OB.DATABASE_URL}}})})();"production"!==t.OB.NODE_ENV&&(o.prisma=s)},1964:(e,i,r)=>{r.d(i,{OB:()=>o});var n=r(88879);let t=n.Ryn({DATABASE_URL:n.Z_8().url("Invalid database URL"),REDIS_URL:n.Z_8().url("Invalid Redis URL").optional(),JWT_SECRET:n.Z_8().min(32,"JWT secret must be at least 32 characters"),NEXTAUTH_SECRET:n.Z_8().min(32,"NextAuth secret must be at least 32 characters").optional(),NEXTAUTH_URL:n.Z_8().url("Invalid NextAuth URL").optional(),STRIPE_SECRET_KEY:n.Z_8().startsWith("sk_","Invalid Stripe secret key").optional(),STRIPE_PUBLISHABLE_KEY:n.Z_8().startsWith("pk_","Invalid Stripe publishable key").optional(),STRIPE_WEBHOOK_SECRET:n.Z_8().optional(),RAZORPAY_KEY_ID:n.Z_8().optional(),RAZORPAY_KEY_SECRET:n.Z_8().optional(),RAZORPAY_WEBHOOK_SECRET:n.Z_8().optional(),WEBHOOK_SECRET:n.Z_8().min(32,"Webhook secret must be at least 32 characters"),FACEBOOK_APP_ID:n.Z_8().optional(),FACEBOOK_APP_SECRET:n.Z_8().optional(),FACEBOOK_PAGE_CONFIG_ID:n.Z_8().optional(),INSTAGRAM_CONFIG_ID:n.Z_8().optional(),GOOGLE_CLIENT_ID:n.Z_8().optional(),GOOGLE_CLIENT_SECRET:n.Z_8().optional(),EVENTBRITE_CLIENT_ID:n.Z_8().optional(),EVENTBRITE_CLIENT_SECRET:n.Z_8().optional(),MEETUP_CLIENT_ID:n.Z_8().optional(),MEETUP_CLIENT_SECRET:n.Z_8().optional(),OAUTH_REDIRECT_BASE:n.Z_8().url("Invalid OAuth redirect base URL").optional(),GRAPH_API_BASE:n.Z_8().url("Invalid Graph API base URL").default("https://graph.facebook.com"),GOOGLE_BUSINESS_API_BASE:n.Z_8().url("Invalid Google Business Profile API base URL").default("https://mybusiness.googleapis.com"),ENCRYPTION_KEY:n.Z_8().length(64,"Encryption key must be 64 hex characters (32 bytes)").optional(),FEATURE_REAL_PROVIDERS:n.Z_8().transform(e=>"true"===e).default("false"),SMTP_HOST:n.Z_8().optional(),SMTP_PORT:n.Z_8().transform(Number).optional(),SMTP_USER:n.Z_8().optional(),SMTP_PASSWORD:n.Z_8().optional(),SMTP_FROM:n.Z_8().email("Invalid SMTP from email").optional(),TWILIO_ACCOUNT_SID:n.Z_8().optional(),TWILIO_AUTH_TOKEN:n.Z_8().optional(),TWILIO_PHONE_NUMBER:n.Z_8().optional(),AWS_ACCESS_KEY_ID:n.Z_8().optional(),AWS_SECRET_ACCESS_KEY:n.Z_8().optional(),AWS_REGION:n.Z_8().optional(),AWS_S3_BUCKET:n.Z_8().optional(),SENTRY_DSN:n.Z_8().url("Invalid Sentry DSN").optional(),NODE_ENV:n.KmV(["development","production","test"]).default("development"),PORT:n.Z_8().transform(Number).default("3000")}),o=(()=>{if("true"===process.env.SKIP_ENV_VALIDATION)return{DATABASE_URL:process.env.DATABASE_URL||"postgresql://dummy:dummy@localhost:5432/dummy",JWT_SECRET:process.env.JWT_SECRET||"dummy-jwt-secret-key-minimum-32-characters-long",WEBHOOK_SECRET:process.env.WEBHOOK_SECRET||"dummy-webhook-secret-key-minimum-32-characters-long",NODE_ENV:"production",PORT:process.env.PORT||"3000",FEATURE_REAL_PROVIDERS:!1,GRAPH_API_BASE:"https://graph.facebook.com",GOOGLE_BUSINESS_API_BASE:"https://mybusiness.googleapis.com"};try{return t.parse(process.env)}catch(e){if(e instanceof n.jmq&&e.errors){let i=e.errors.filter(e=>"invalid_type"===e.code&&"undefined"===e.received).map(e=>e.path.join(".")),r=e.errors.filter(e=>"invalid_type"!==e.code).map(e=>`${e.path.join(".")}: ${e.message}`),n="Environment validation failed:\n";throw i.length>0&&(n+=`
Missing required variables:
${i.map(e=>`  - ${e}`).join("\n")}`),r.length>0&&(n+=`
Invalid variables:
${r.map(e=>`  - ${e}`).join("\n")}`),Error(n)}throw e}})();o.NODE_ENV,o.NODE_ENV,o.NODE_ENV},67829:(e,i,r)=>{r.d(i,{Z4:()=>t,h0:()=>o,lx:()=>a});var n=r(53524);function t(e,i,r){let t=r.end.getTime()-r.start.getTime(),o=Math.ceil(t/36e5),a=Math.ceil(t/864e5),s=[],l=0,u=0,d=0,_=0,p=0,E=i.find(e=>e.kind===n.PricingKind.HOURLY),c=i.find(e=>e.kind===n.PricingKind.DAILY);if(c&&o>=8&&c){let e=c.amount*a;u=e,s.push({label:`Daily rate (${a} day${a>1?"s":""})`,amount:e,kind:n.PricingKind.DAILY})}else if(E){let e=E.amount*o;u=e,s.push({label:`Hourly rate (${o} hour${o>1?"s":""})`,amount:e,kind:n.PricingKind.HOURLY})}let m=i.find(e=>e.kind===n.PricingKind.PEAK);if(m&&function(e,i,r){if(r.dow&&r.dow.length>0){let n=e.getDay(),t=i.getDay();if(!r.dow.some(e=>n<=t?e>=n&&e<=t:e>=n||e<=t))return!1}if(null!==r.startHour&&null!==r.endHour){let n=e.getHours();return!(i.getHours()<=r.startHour||n>=r.endHour)}return!0}(r.start,r.end,m)){let e=function(e,i,r){let n=Math.ceil((r.end.getTime()-r.start.getTime())/36e5);return Math.round(Math.max(0,i.amount-e/n)*n)}(u,m,r);e>0&&(d=e,s.push({label:"Peak time surcharge",amount:e,kind:n.PricingKind.PEAK}))}let P=i.find(e=>e.kind===n.PricingKind.CLEANING_FEE);P&&(_=P.amount,s.push({label:"Cleaning fee",amount:_,kind:n.PricingKind.CLEANING_FEE}));let R=i.find(e=>e.kind===n.PricingKind.SECURITY_DEPOSIT);R&&(p=R.amount,s.push({label:"Security deposit",amount:p,kind:n.PricingKind.SECURITY_DEPOSIT}));let A=(l=u+d+_)+p;return{lines:s,subtotal:l,total:A,currency:i[0]?.currency||"USD",breakdown:{base:u,peak:d,cleaning:_,deposit:p}}}function o(e){let i=e.find(e=>e.kind===n.PricingKind.HOURLY),r=e.find(e=>e.kind===n.PricingKind.DAILY),t=i?.amount||0;if(r){let e=Math.ceil(r.amount/8);t=t>0?Math.min(t,e):e}return t}function a(e){let i=[],r=e.some(e=>e.kind===n.PricingKind.HOURLY),t=e.some(e=>e.kind===n.PricingKind.DAILY);r||t||i.push("At least one base pricing rule (hourly or daily) is required");let o=e.map(e=>e.kind),a=o.filter((e,i)=>o.indexOf(e)!==i);for(let r of(a.length>0&&i.push(`Duplicate pricing rule types: ${a.join(", ")}`),e.filter(e=>e.kind===n.PricingKind.PEAK)))r.dow&&0===r.dow.length&&(null===r.startHour||null===r.endHour)&&i.push("Peak pricing rule must specify either days of week or time range");return i}}};var i=require("../../../../../webpack-runtime.js");i.C(e);var r=e=>i(i.s=e),n=i.X(0,[8948,147,5972],()=>r(48826));module.exports=n})();