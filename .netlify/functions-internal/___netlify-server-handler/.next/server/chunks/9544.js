"use strict";exports.id=9544,exports.ids=[9544],exports.modules={14749:(e,t,r)=>{r.d(t,{ar:()=>a,sZ:()=>i});var o=r(9487),n=r(57435),E=r(60581);let i={LISTING_CREATED:"listing.created",LISTING_UPDATED:"listing.updated",LISTING_DELETED:"listing.deleted",LISTING_PUBLISHED:"listing.published",LISTING_UNPUBLISHED:"listing.unpublished",ORDER_CREATED:"order.created",ORDER_UPDATED:"order.updated",ORDER_CANCELLED:"order.cancelled",ORDER_REFUNDED:"order.refunded",SLOT_CREATED:"slot.created",SLOT_UPDATED:"slot.updated",SLOT_DELETED:"slot.deleted",SLOTS_IMPORTED:"slots.imported",SLOTS_EXPORTED:"slots.exported",WIDGET_CREATED:"widget.created",WIDGET_UPDATED:"widget.updated",WIDGET_DELETED:"widget.deleted",WIDGET_GENERATED:"widget.generated",SOCIAL_POST_CREATED:"social.post.created",SOCIAL_POST_PUBLISHED:"social.post.published",SOCIAL_POST_FAILED:"social.post.failed",SOCIAL_TEST_POST:"social.test.post",SOCIAL_ACCOUNT_CONNECTED:"social.account.connected",SOCIAL_ACCOUNT_DISCONNECTED:"social.account.disconnected",PROVIDER_CONNECTED:"provider.connected",PROVIDER_DISCONNECTED:"provider.disconnected",PROVIDER_RECONNECT_REQUESTED:"provider.reconnect.requested",PROVIDER_REFRESHED:"provider.refreshed",EVENT_SYNC_CREATED:"event.sync.created",EVENT_SYNC_UPDATED:"event.sync.updated",EVENT_SYNC_DELETED:"event.sync.deleted",EVENT_SYNC_PUBLISHED:"event.sync.published",EVENT_SYNC_IMPORTED:"event.sync.imported",EVENT_PUBLISHED:"event.published",EVENT_UPDATED:"event.updated",EVENT_FAILED:"event.failed",EVENT_TEST_PUBLISH:"event.test.publish",COUPON_CREATED:"coupon.created",COUPON_UPDATED:"coupon.updated",COUPON_DELETED:"coupon.deleted",AFFILIATE_CREATED:"affiliate.created",AFFILIATE_UPDATED:"affiliate.updated",AFFILIATE_DELETED:"affiliate.deleted",SETTINGS_UPDATED:"settings.updated",USER_CREATED:"user.created",USER_UPDATED:"user.updated",USER_DELETED:"user.deleted",WEBHOOK_CREATED:"webhook.created",WEBHOOK_UPDATED:"webhook.updated",WEBHOOK_DELETED:"webhook.deleted",API_KEY_CREATED:"api.key.created",API_KEY_DELETED:"api.key.deleted",LOGIN:"user.login",LOGOUT:"user.logout",PASSWORD_CHANGED:"user.password.changed",PERMISSION_CHANGED:"user.permission.changed"},a=async(e,t,r,i,a,s,l={},_)=>{try{let d=await o.db.auditLog.create({data:{id:(0,E.x0)(),actorId:e,actorType:t,action:r,entityType:i,entityId:a,businessId:s,metadata:JSON.stringify(l),ipAddress:_?.ipAddress,userAgent:_?.userAgent}});return n.k.info(`Audit log created: ${r} on ${i}:${a} by ${t}:${e}`),d}catch(e){throw n.k.error("Failed to create audit log entry:",e),e}}},67297:(e,t,r)=>{r.d(t,{n0:()=>i,sw:()=>a});var o=r(1964),n=r(57435);class E{static{this.ALGORITHM="AES-GCM"}static{this.KEY_LENGTH=32}static{this.IV_LENGTH=12}static{this.TAG_LENGTH=16}static getKey(){if(!o.OB.ENCRYPTION_KEY)return n.k.warn("ENCRYPTION_KEY not configured, tokens will be stored in plain text"),null;try{let e=Buffer.from(o.OB.ENCRYPTION_KEY,"base64");if(e.length!==this.KEY_LENGTH)throw Error(`Invalid key length: expected ${this.KEY_LENGTH}, got ${e.length}`);return crypto.subtle.importKey("raw",e,{name:this.ALGORITHM},!1,["encrypt","decrypt"])}catch(e){return n.k.error("Failed to import encryption key:",e),null}}static async encryptToken(e){let t=await this.getKey();if(!t)return Buffer.from(e).toString("base64");try{let r=crypto.getRandomValues(new Uint8Array(this.IV_LENGTH)),o=new TextEncoder().encode(e),n=await crypto.subtle.encrypt({name:this.ALGORITHM,iv:r,tagLength:8*this.TAG_LENGTH},t,o),E=new Uint8Array(r.length+n.byteLength);return E.set(r,0),E.set(new Uint8Array(n),r.length),Buffer.from(E).toString("base64")}catch(e){throw n.k.error("Failed to encrypt token:",e),Error("Token encryption failed")}}static async decryptToken(e){let t=await this.getKey();if(!t)try{return Buffer.from(e,"base64").toString("utf-8")}catch{throw Error("Token decryption failed - invalid format")}try{let r=Buffer.from(e,"base64"),o=r.slice(0,this.IV_LENGTH),n=r.slice(this.IV_LENGTH),E=await crypto.subtle.decrypt({name:this.ALGORITHM,iv:o,tagLength:8*this.TAG_LENGTH},t,n);return new TextDecoder().decode(E)}catch(e){throw n.k.error("Failed to decrypt token:",e),Error("Token decryption failed")}}static generateEncryptionKey(){let e=crypto.getRandomValues(new Uint8Array(this.KEY_LENGTH));return Buffer.from(e).toString("base64")}}let i=E.encryptToken,a=E.decryptToken;E.generateEncryptionKey},9487:(e,t,r)=>{r.d(t,{db:()=>a});var o=r(53524),n=r(1964);let E=globalThis,i=()=>({$queryRaw:()=>Promise.resolve([]),$executeRaw:()=>Promise.resolve(0),$transaction:e=>e({}),user:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},business:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},space:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},socialAccount:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},webhookDelivery:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},auditLog:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},spaceAvailability:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)},spaceRequest:{findMany:()=>Promise.resolve([]),findFirst:()=>Promise.resolve(null)}}),a=(()=>{process.env.SKIP_ENV_VALIDATION;try{return E.prisma??new o.PrismaClient({log:"development"===n.OB.NODE_ENV?["query","error","warn"]:["error"],datasources:{db:{url:n.OB.DATABASE_URL}}})}catch(e){return console.warn("Database connection failed during build, using mock database:",e),i()}return E.prisma??new o.PrismaClient({log:"development"===n.OB.NODE_ENV?["query","error","warn"]:["error"],datasources:{db:{url:n.OB.DATABASE_URL}}})})();"production"!==n.OB.NODE_ENV&&(E.prisma=a)},1964:(e,t,r)=>{r.d(t,{OB:()=>E});var o=r(88879);let n=o.Ryn({DATABASE_URL:o.Z_8().url("Invalid database URL"),REDIS_URL:o.Z_8().url("Invalid Redis URL").optional(),JWT_SECRET:o.Z_8().min(32,"JWT secret must be at least 32 characters"),NEXTAUTH_SECRET:o.Z_8().min(32,"NextAuth secret must be at least 32 characters").optional(),NEXTAUTH_URL:o.Z_8().url("Invalid NextAuth URL").optional(),STRIPE_SECRET_KEY:o.Z_8().startsWith("sk_","Invalid Stripe secret key").optional(),STRIPE_PUBLISHABLE_KEY:o.Z_8().startsWith("pk_","Invalid Stripe publishable key").optional(),STRIPE_WEBHOOK_SECRET:o.Z_8().optional(),RAZORPAY_KEY_ID:o.Z_8().optional(),RAZORPAY_KEY_SECRET:o.Z_8().optional(),RAZORPAY_WEBHOOK_SECRET:o.Z_8().optional(),WEBHOOK_SECRET:o.Z_8().min(32,"Webhook secret must be at least 32 characters"),FACEBOOK_APP_ID:o.Z_8().optional(),FACEBOOK_APP_SECRET:o.Z_8().optional(),FACEBOOK_PAGE_CONFIG_ID:o.Z_8().optional(),INSTAGRAM_CONFIG_ID:o.Z_8().optional(),GOOGLE_CLIENT_ID:o.Z_8().optional(),GOOGLE_CLIENT_SECRET:o.Z_8().optional(),EVENTBRITE_CLIENT_ID:o.Z_8().optional(),EVENTBRITE_CLIENT_SECRET:o.Z_8().optional(),MEETUP_CLIENT_ID:o.Z_8().optional(),MEETUP_CLIENT_SECRET:o.Z_8().optional(),OAUTH_REDIRECT_BASE:o.Z_8().url("Invalid OAuth redirect base URL").optional(),GRAPH_API_BASE:o.Z_8().url("Invalid Graph API base URL").default("https://graph.facebook.com"),GOOGLE_BUSINESS_API_BASE:o.Z_8().url("Invalid Google Business Profile API base URL").default("https://mybusiness.googleapis.com"),ENCRYPTION_KEY:o.Z_8().length(64,"Encryption key must be 64 hex characters (32 bytes)").optional(),FEATURE_REAL_PROVIDERS:o.Z_8().transform(e=>"true"===e).default("false"),SMTP_HOST:o.Z_8().optional(),SMTP_PORT:o.Z_8().transform(Number).optional(),SMTP_USER:o.Z_8().optional(),SMTP_PASSWORD:o.Z_8().optional(),SMTP_FROM:o.Z_8().email("Invalid SMTP from email").optional(),TWILIO_ACCOUNT_SID:o.Z_8().optional(),TWILIO_AUTH_TOKEN:o.Z_8().optional(),TWILIO_PHONE_NUMBER:o.Z_8().optional(),AWS_ACCESS_KEY_ID:o.Z_8().optional(),AWS_SECRET_ACCESS_KEY:o.Z_8().optional(),AWS_REGION:o.Z_8().optional(),AWS_S3_BUCKET:o.Z_8().optional(),SENTRY_DSN:o.Z_8().url("Invalid Sentry DSN").optional(),NODE_ENV:o.KmV(["development","production","test"]).default("development"),PORT:o.Z_8().transform(Number).default("3000")}),E=(()=>{if("true"===process.env.SKIP_ENV_VALIDATION)return{DATABASE_URL:process.env.DATABASE_URL||"postgresql://dummy:dummy@localhost:5432/dummy",JWT_SECRET:process.env.JWT_SECRET||"dummy-jwt-secret-key-minimum-32-characters-long",WEBHOOK_SECRET:process.env.WEBHOOK_SECRET||"dummy-webhook-secret-key-minimum-32-characters-long",NODE_ENV:"production",PORT:process.env.PORT||"3000",FEATURE_REAL_PROVIDERS:!1,GRAPH_API_BASE:"https://graph.facebook.com",GOOGLE_BUSINESS_API_BASE:"https://mybusiness.googleapis.com"};try{return n.parse(process.env)}catch(e){if(e instanceof o.jmq&&e.errors){let t=e.errors.filter(e=>"invalid_type"===e.code&&"undefined"===e.received).map(e=>e.path.join(".")),r=e.errors.filter(e=>"invalid_type"!==e.code).map(e=>`${e.path.join(".")}: ${e.message}`),o="Environment validation failed:\n";throw t.length>0&&(o+=`
Missing required variables:
${t.map(e=>`  - ${e}`).join("\n")}`),r.length>0&&(o+=`
Invalid variables:
${r.map(e=>`  - ${e}`).join("\n")}`),Error(o)}throw e}})();E.NODE_ENV,E.NODE_ENV,E.NODE_ENV},60581:(e,t,r)=>{r.d(t,{x0:()=>o.x0});var o=r(42549);(0,o.kP)("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",8),(0,o.kP)("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",10),(0,o.kP)("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",8)},57435:(e,t,r)=>{r.d(t,{k:()=>o});let o={info:(e,...t)=>{console.log(`[INFO] ${e}`,...t)},warn:(e,...t)=>{console.warn(`[WARN] ${e}`,...t)},error:(e,...t)=>{console.error(`[ERROR] ${e}`,...t)},debug:(e,...t)=>{}}},42549:(e,t,r)=>{let o,n;r.d(t,{kP:()=>a,x0:()=>s});var E=r(6005);function i(e){!o||o.length<e?(o=Buffer.allocUnsafe(128*e),E.webcrypto.getRandomValues(o),n=0):n+e>o.length&&(E.webcrypto.getRandomValues(o),n=0),n+=e}function a(e,t=21){var r;let E,a;return r=t,a=Math.ceil(1.6*(E=(2<<31-Math.clz32(e.length-1|1))-1)*r/e.length),(t=r)=>{if(!t)return"";let s="";for(;;){var l;let r=(i(l=0|a),o.subarray(n-l,n)),_=a;for(;_--;)if((s+=e[r[_]&E]||"").length>=t)return s}}}function s(e=21){i(e|=0);let t="";for(let r=n-e;r<n;r++)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&o[r]];return t}}};